<idea-plugin>
    <id>ru.dsudomoin.claude-code-gui</id>
    <name>Ultimate Claude GUI</name>
    <vendor url="https://github.com/dsudomoin">dsudomoin</vendor>
    <description><![CDATA[
        Native IntelliJ plugin for AI-powered coding with Claude.
        Compose/Jewel UI, communicates via Node.js bridge wrapping @anthropic-ai/claude-code SDK.
    ]]></description>

    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.vcs</depends>
    <depends>com.intellij.modules.compose</depends>

    <dependencies>
        <!-- Jewel Markdown modules for Compose-based markdown rendering -->
        <module name="intellij.platform.jewel.markdown.core"/>
        <module name="intellij.platform.jewel.markdown.ideLafBridgeStyling"/>
        <module name="intellij.platform.jewel.markdown.extensions.gfmTables"/>
        <module name="intellij.platform.jewel.markdown.extensions.gfmAlerts"/>
        <module name="intellij.platform.jewel.markdown.extensions.gfmStrikethrough"/>
        <module name="intellij.platform.jewel.markdown.extensions.autolink"/>
    </dependencies>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Tool Window -->
        <toolWindow id="Claude Code" anchor="right"
                    icon="AllIcons.Toolwindows.ToolWindowPalette"
                    canCloseContents="true"
                    factoryClass="ru.dsudomoin.claudecodegui.ui.toolwindow.ClaudeToolWindowFactory"/>

        <!-- Services -->
        <applicationService
                serviceImplementation="ru.dsudomoin.claudecodegui.service.SettingsService"/>
        <applicationService
                serviceImplementation="ru.dsudomoin.claudecodegui.service.OAuthCredentialService"/>

        <projectService
                serviceImplementation="ru.dsudomoin.claudecodegui.core.session.SessionManager"/>
        <projectService
                serviceImplementation="ru.dsudomoin.claudecodegui.service.ProjectFileIndexService"/>

        <!-- Settings -->
        <applicationConfigurable parentId="tools"
                                 instance="ru.dsudomoin.claudecodegui.settings.ClaudeSettingsConfigurable"
                                 id="ru.dsudomoin.claudecodegui.settings"
                                 displayName="Ultimate Claude GUI"/>
        <applicationConfigurable parentId="ru.dsudomoin.claudecodegui.settings"
                                 instance="ru.dsudomoin.claudecodegui.settings.AppearanceConfigurable"
                                 id="ru.dsudomoin.claudecodegui.settings.appearance"
                                 displayName="Appearance"/>

        <!-- Notifications -->
        <notificationGroup id="Claude Code" displayType="BALLOON"/>
    </extensions>

    <actions>
        <action id="Claude.SendSelection"
                class="ru.dsudomoin.claudecodegui.action.SendSelectionAction"
                text="Send to Claude"
                description="Send selected code or file context to Claude Code chat"
                icon="AllIcons.Actions.Execute">
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt K"/>
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>
        </action>

        <action id="Claude.GenerateCommitMessage"
                class="ru.dsudomoin.claudecodegui.action.GenerateCommitAction"
                text="Generate Commit Message with Claude"
                description="Generate a commit message from staged changes using Claude AI"
                icon="AllIcons.Actions.InlayRenameInNoCodeFilesActive">
            <add-to-group group-id="Vcs.MessageActionGroup" anchor="last"/>
        </action>
    </actions>
</idea-plugin>
